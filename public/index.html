<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>MidwayUSA - Skills Map Manager</title>
    <link
      rel="icon"
      type="image/png"
      href="https://media.mwstatic.com/images/pagespecific/favicons/favicon-96x96.png"
    />
    <link type="text/css" rel="stylesheet" href="/main.css" />
  </head>
  <body>
    <main>
      <form>
        <table>
          <thead>
            <tr>
              <th>Skill</th>
              <th>Defnintion</th>
              <th>Group</th>
              <th>weight</th>
              <th>&nbsp;</th>
            </tr>
            <tr>
              <td><input type="text" name="id" /></td>
              <td><textarea name="description"></textarea></td>
              <td><input type="text" name="group" /></td>
              <td><input type="text" name="weight" /></td>
              <td><button type="submit">Add</button></td>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </form>
    </main>
    <script>
      const render = nodes => {
        const items = nodes.map(node => {
          return `<tr>
              <td><input type="text" name="id" value=${node.id} /></td>
              <td><textarea name="description">${
                node.description
              }</textarea></td>
              <td><input type="text" name="group" value=${node.group} /></td>
              <td><input type="text" name="weight" value=${node.weight} /></td>
              <td>&nbsp;</td>
            </tr>`
        })

        const html = items.join("")
        document.querySelector("tbody").innerHTML = html
      }

      document.querySelector("form").addEventListener("submit", e => {
        e.preventDefault()
        let json = {}
        const formData = new FormData(e.currentTarget)
        const entries = Object.fromEntries(formData)
        console.log(entries)

        // const json = JSON.stringify(Object.fromEntries(formData.getAll()))
        // console.log(json)
      })

      fetch("/api/nodes")
        .then(response => {
          return response.json()
        })
        .then(render)
    </script>
  </body>
</html>
